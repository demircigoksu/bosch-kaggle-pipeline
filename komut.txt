# WSL'de kurulum:
# 1. Virtual environment oluÅŸtur (ilk sefer)
python3 -m venv .venv
source .venv/bin/activate

# 2. Paketleri yÃ¼kle
python -m pip install --upgrade pip
python -m pip install -r bosch/requirements.txt

# 3. Otomatik venv aktivasyonu (Ã–NERÄ°LEN):
#    Proje dizinine girdiÄŸinizde venv otomatik aktif olur
bash setup_wsl_auto_venv.sh
#    Sonra yeni terminal aÃ§Ä±n veya: source ~/.bashrc

# Alternatif: Manuel aktivasyon
source .venv/bin/activate
# Veya: source activate_venv.sh

# Ã–nce gerekli paketleri yÃ¼kle (virtual env sorunu varsa python -m pip kullan):
python -m pip install pyyaml psutil
# Veya: python -m pip install -r bosch/requirements.txt

# Yerel test:
python bosch/scripts/train_bosch.py data --quick
python bosch/scripts/submit_bosch.py data

# ============================================
# KAGGLE NOTEBOOK'DA Ã‡ALIÅTIRMA
# ============================================
# 
# AdÄ±m 1: Kaggle notebook oluÅŸtur ve veri setini ekle
# AdÄ±m 2: Kod dosyalarÄ±nÄ± yÃ¼kle (GitHub clone veya dataset olarak)
# AdÄ±m 3: AÅŸaÄŸÄ±daki komutlarÄ± notebook hÃ¼crelerinde Ã§alÄ±ÅŸtÄ±r:
#
# HÃ¼cre 1: Setup
# !git clone https://github.com/KULLANICI_ADI/bosch-kaggle-pipeline.git
# !pip install pyyaml psutil
# import os
# os.chdir('/kaggle/working/bosch-kaggle-pipeline')
#
# HÃ¼cre 2: Quick Test (1 fold, ~30 dakika)
# !python bosch/scripts/train_bosch.py /kaggle/input/bosch-production-line-performance --quick
#
# HÃ¼cre 3: Full Training (5 folds, birkaÃ§ saat)
# !python bosch/scripts/train_bosch.py /kaggle/input/bosch-production-line-performance
#
# HÃ¼cre 4: Submission OluÅŸtur
# !python bosch/scripts/submit_bosch.py /kaggle/input/bosch-production-line-performance
#
# DetaylÄ± rehber iÃ§in: KAGGLE_NOTEBOOK_GUIDE.md dosyasÄ±na bakÄ±n

cd /home/goksu/code/bosch-kaggle-pipeline
bash init_and_push.sh

cd /home/goksu/code/bosch-kaggle-pipeline
chmod +x setup_wsl_auto_venv.sh
bash setup_wsl_auto_venv.sh
source ~/.bashrc

HÃ¼cre 1: Setup ve Clone
# GitHub'dan kodlarÄ± Ã§ek
!git clone https://github.com/demircigoksu/bosch-kaggle-pipeline.git

# Gerekli paketleri yÃ¼kle
!pip install pyyaml psutil

# Proje dizinine git
import os
os.chdir('/kaggle/working/bosch-kaggle-pipeline')

# Kontrol
print("âœ… Setup complete!")
print("Current directory:", os.getcwd())
print("\nBosch scripts:")
!ls -la bosch/scripts/

HÃ¼cre 2: Veri Dizinini Kontrol Et
# Veri dizinini kontrol et
import os

data_dir = '/kaggle/input/bosch-production-line-performance'
print(f"Data directory: {data_dir}")
print(f"Exists: {os.path.exists(data_dir)}")

if os.path.exists(data_dir):
    files = os.listdir(data_dir)
    zip_files = [f for f in files if f.endswith('.zip')]
    print(f"\nâœ… Found {len(zip_files)} zip files")
    print("Zip files will be automatically extracted when needed!")

HÃ¼cre 3: Quick Test (1 fold, ~30 dakika)
# Quick test - 1 fold ile hÄ±zlÄ± test
# Zip dosyalarÄ± otomatik aÃ§Ä±lacak!
!python bosch/scripts/train_bosch.py /kaggle/input/bosch-production-line-performance --quick

HÃ¼cre 4: Full Training (5 folds, birkaÃ§ saat)
# Full training - 5 fold cross-validation
# Zip dosyalarÄ± otomatik aÃ§Ä±lacak!
!python bosch/scripts/train_bosch.py /kaggle/input/bosch-production-line-performance

HÃ¼cre 5: Submission OluÅŸtur
# Submission dosyasÄ± oluÅŸtur
!python bosch/scripts/submit_bosch.py /kaggle/input/bosch-production-line-performance

HÃ¼cre 6: SonuÃ§larÄ± Kontrol Et
# Submission dosyasÄ±nÄ± kontrol et
import pandas as pd
import os

submission_path = '/kaggle/working/bosch-kaggle-pipeline/bosch/outputs/submissions/submission.csv'

if os.path.exists(submission_path):
    submission = pd.read_csv(submission_path)
    
    print("âœ… Submission created successfully!")
    print("\nSubmission Preview:")
    print(submission.head(10))
    print(f"\nShape: {submission.shape}")
    print(f"\nResponse value counts:")
    print(submission['Response'].value_counts())
    print(f"\nResponse distribution:")
    print(submission['Response'].value_counts(normalize=True))
    
    # Dosya boyutu
    file_size = os.path.getsize(submission_path) / 1024  # KB
    print(f"\nFile size: {file_size:.2f} KB")
    print(f"\nğŸ“ Submission path: {submission_path}")
else:
    print("âŒ Submission file not found!")